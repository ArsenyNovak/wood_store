import re
from aiogram.types import Message
from wood_app.bot.kbs import main_keyboard


def get_about_us_text() -> str:
    return """
üåü –≠—Ç–æ –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–æ–µ–∫—Ç –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≤–º–µ—â–∞–µ—Ç 
–¥–≤–∞ –º–æ–∏—Ö –∑–∞–Ω—è—Ç–∏—è: 
 - –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ üë®‚Äçüíª; 
 - –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ –∏–∑–¥–µ–ª–∏–π –∏–∑ –¥–µ—Ä–µ–≤–∞ ü™µ.
 –ó–¥–µ—Å—å —è –±—É–¥—É –≤—ã–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å–≤–æ–∏ –ø–æ–¥–µ–ª–∫–∏ –∏–∑ –¥–µ—Ä–µ–≤–∞,
 –∞ —Ç–∞–∫–∂–µ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –±—É–¥—É –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.
 
 p.s. üìù –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ –∑–∞–º–µ—á–∞–Ω–∏—è –≤—ã –∑–Ω–∞–µ—Ç–µ –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å.
"""


async def greet_user(message: Message, is_new_user: bool) -> None:
    """
    –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
    """
    greeting = "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å" if is_new_user else "–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º"
    status = "–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã!" if is_new_user else "–†–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å —Å–Ω–æ–≤–∞!"
    await message.answer(
        f"{greeting}, <b>{message.from_user.full_name}</b>! {status}\n"
        "–ß–µ–º —è –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å–µ–≥–æ–¥–Ω—è?",
        reply_markup=main_keyboard(user_id=message.from_user.id, first_name=message.from_user.first_name)
    )


def cyrillicToLatin(text):

    dic_change = {'–∞':'a', '–±':'b', '–≤':'v', '–≥':'g', '–¥':'d', '–µ':'e',
    '—ë':'yo', '–∂':'zh', '–∑':'z', '–∏':'i', '–π':'y', '–∫':'k',
    '–ª':'l', '–º':'m', '–Ω':'n', '–æ':'o', '–ø':'p', '—Ä':'r',
    '—Å':'s', '—Ç':'t', '—É':'u', '—Ñ':'f', '—Ö':'kh', '—Ü':'ts',
    '—á':'ch', '—à':'sh', '—â':'shch', '—ä':'"', '—ã':'y', '—å':"'",
    '—ç':'e', '—é':'yu', '—è':'ya'
                  }

    text = text.lower()
    translit_text = ''.join(dic_change.get(ch, ch) for ch in text)

    # –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤, –∫—Ä–æ–º–µ –±—É–∫–≤, —Ü–∏—Ñ—Ä –∏ –ø—Ä–æ–±–µ–ª–æ–≤
    translit_text = re.sub(r'[^a-z0-9\s-]', '', translit_text)

    # –ó–∞–º–µ–Ω–∞ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –ø–æ–¥—Ä—è–¥ –∏–¥—É—â–∏—Ö –¥–µ—Ñ–∏—Å–æ–≤/–ø—Ä–æ–±–µ–ª–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—á–Ω—ã–π –¥–µ—Ñ–∏—Å
    translit_text = re.sub(r'[\s-]+', '_', translit_text)

    # –£–¥–∞–ª–µ–Ω–∏–µ –¥–µ—Ñ–∏—Å–æ–≤ —Å –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫–∏
    translit_text = translit_text.strip('-')

    return translit_text